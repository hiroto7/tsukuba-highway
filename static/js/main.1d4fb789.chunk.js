(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{44:function(t,e,a){t.exports=a(66)},50:function(t,e,a){},52:function(t,e,a){},66:function(t,e,a){"use strict";a.r(e);var n=a(0),r=a.n(n),s=a(17),o=a.n(s),i=(a(50),a(14)),c=a(26),l=a(15),d=a.n(l),u=a(25),m=a(33),p=a(34),h=a(41),f=a(35),b=a(42),g=(a(52),a(78)),w=a(80),v=a(81),y=a(74),E=a(82),_=a(79),k=(a(53),a(75)),x=a(69),j=a(70),O=a(71),N=a(72),S=a(77),C=a(73),L=a(76),R=function(t){return r.a.createElement(S.a,null,r.a.createElement(L.a,{variant:"flush"},Object(i.a)(t.roads).map(function(e){return r.a.createElement(L.a.Item,{action:!0,active:e===t.selected,key:e,onClick:function(){return t.onClick(e)}},e)})))},z="http://localhost:3030/tsukuba-highway/query",I=function(t){function e(t){var a;return Object(m.a)(this,e),(a=Object(h.a)(this,Object(f.a)(e).call(this,t))).state={isLoading:!1,roadNames:null,road:null,map:{zoom:13,center:{lat:36.0824938,lng:140.0958208}}},a}return Object(b.a)(e,t),Object(p.a)(e,[{key:"componentDidMount",value:function(){this.updateRoadList()}},{key:"updateRoadList",value:function(){var t=Object(u.a)(d.a.mark(function t(){var e,a,n,r;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.setState({isLoading:!0}),'prefix bp: <http://www.coins.tsukuba.ac.jp/~s1711402/lod/tsukuba-highway/property/>\nprefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n\nselect distinct * where {\n  ?road bp:category "road" ;\n    rdfs:label ?roadLabel .\n}',t.next=5,fetch("".concat(z,"?query=").concat(encodeURIComponent('prefix bp: <http://www.coins.tsukuba.ac.jp/~s1711402/lod/tsukuba-highway/property/>\nprefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n\nselect distinct * where {\n  ?road bp:category "road" ;\n    rdfs:label ?roadLabel .\n}')),{headers:{Accept:"application/sparql-results+json"}});case 5:return e=t.sent,t.next=8,e.text();case 8:a=t.sent,n=function(){try{return JSON.parse(a)}catch(t){throw console.error(a),t}}(),r=function(){try{return n.results.bindings.map(function(t){return t.roadLabel.value})}catch(t){throw console.error(n),t}}(),this.setState({roadNames:r}),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),console.error(t.t0);case 17:return t.prev=17,this.setState({isLoading:!1}),t.finish(17);case 20:case"end":return t.stop()}},t,this,[[0,14,17,20]])}));return function(){return t.apply(this,arguments)}}()},{key:"getRoadDetails",value:function(){var t=Object(u.a)(d.a.mark(function t(e){var a,n,r,s,o,i,l,m,p,h,f;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.setState({isLoading:!0}),a=['prefix bp: <http://www.coins.tsukuba.ac.jp/~s1711402/lod/tsukuba-highway/property/>\nprefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nprefix ic: <http://imi.go.jp/ns/core/rdf#>\n\nselect distinct ?start_lng ?start_lat ?end_lng ?end_lat ?length ?route ?lanes_count where {\n  ?road bp:category "road" ;\n    rdfs:label "'.concat(e,'"@ja ;\n    bp:\u8d77\u70b9 ?start ;\n    bp:\u7d42\u70b9 ?end ;\n    bp:length ?length ;\n    bp:route ?route ;\n    bp:\u8eca\u7dda\u6570 ?lanes_count .\n  {\n    ?start ic:\u7d4c\u5ea6 ?start_lng .\n    ?start ic:\u7def\u5ea6 ?start_lat .\n    bind(2 as ?start_priority) .\n  } union {\n    ?start ic:\u5ea7\u6a19 ?start_coordinate .\n    ?start_coordinate ic:\u7d4c\u5ea6 ?start_lng .\n    ?start_coordinate ic:\u7def\u5ea6 ?start_lat .\n    bind(1 as ?start_priority) .\n  }\n\n  {\n    ?end ic:\u7d4c\u5ea6 ?end_lng .\n    ?end ic:\u7def\u5ea6 ?end_lat .\n    bind(2 as ?end_priority) .\n  } union {\n    ?end ic:\u5ea7\u6a19 ?end_coordinate .\n    ?end_coordinate ic:\u7d4c\u5ea6 ?end_lng .\n    ?end_coordinate ic:\u7def\u5ea6 ?end_lat .\n    bind(1 as ?end_priority) .\n  }\n\n  filter(str(?end_lng) != "") .\n  filter(str(?end_lat) != "") .\n  filter(str(?start_lng) != "") .\n  filter(str(?start_lat) != "") .\n} order by desc(?start_priority) desc(?end_priority)'),'prefix bp: <http://www.coins.tsukuba.ac.jp/~s1711402/lod/tsukuba-highway/property/>\nprefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n\nselect distinct ?start_name ?end_name where {\n  ?road bp:category "road" ;\n    rdfs:label "'.concat(e,'"@ja .\n  {\n    ?road bp:\u8d77\u70b9 ?start_name .\n    filter(isliteral(?start_name)) .\n  } union {\n    ?road bp:\u8d77\u70b9 ?start .\n    ?start rdfs:label ?start_name .\n  }\n  \n  {\n    ?road bp:\u7d42\u70b9 ?end_name .\n    filter(isliteral(?end_name)) .\n  } union {\n    ?road bp:\u7d42\u70b9 ?end .\n    ?end rdfs:label ?end_name .\n  }\n}')],t.next=5,Promise.all(a.map(function(){var t=Object(u.a)(d.a.mark(function t(e){var a,n;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(z,"?query=").concat(encodeURIComponent(e)),{headers:{Accept:"application/sparql-results+json"}});case 2:return a=t.sent,t.next=5,a.text();case 5:return n=t.sent,t.prev=6,t.abrupt("return",JSON.parse(n));case 10:throw t.prev=10,t.t0=t.catch(6),console.error(n),t.t0;case 14:case"end":return t.stop()}},t,null,[[6,10]])}));return function(e){return t.apply(this,arguments)}}()));case 5:return n=t.sent,r=function(){try{var t={coordinate:{lat:+n[0].results.bindings[0].start_lat.value,lng:+n[0].results.bindings[0].start_lng.value},names:new Set(n[1].results.bindings.map(function(t){return t.start_name.value}))},e={coordinate:{lat:+n[0].results.bindings[0].end_lat.value,lng:+n[0].results.bindings[0].end_lng.value},names:new Set(n[1].results.bindings.map(function(t){return t.end_name.value}))},a=+n[0].results.bindings[0].length.value,r=n[0].results.bindings[0].route.value;return{length:a,lanesCounts:new Set(n[0].results.bindings.map(function(t){return+t.lanes_count.value})),start:t,end:e,routeURI:r}}catch(s){throw console.error(n[0],n[1]),s}}(),s=r.length,o=r.lanesCounts,i=r.start,l=r.end,m=r.routeURI,t.next=9,fetch(m);case 9:return p=t.sent,t.next=12,p.text();case 12:h=t.sent,f=function(){try{return JSON.parse(h)}catch(t){throw console.error(h),t}}(),this.setState({road:{name:e,route:f,length:s,lanesCounts:o,start:i,end:l},map:Object(c.a)({},this.state.map,{center:{lat:(i.coordinate.lat+l.coordinate.lat)/2,lng:(i.coordinate.lng+l.coordinate.lng)/2}})}),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(0),console.error(t.t0);case 20:return t.prev=20,this.setState({isLoading:!1}),t.finish(20);case 23:case"end":return t.stop()}},t,this,[[0,17,20,23]])}));return function(e){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return r.a.createElement("div",{className:"App"},r.a.createElement(k.a,{variant:"dark",bg:"dark",className:"justify-content-between"},r.a.createElement(k.a.Brand,null,"\u3064\u304f\u3070\u5e02\u5468\u8fba\u306e\u5e79\u7dda\u9053\u8def"),this.state.isLoading?r.a.createElement(x.a,{animation:"border",variant:"primary"}):""),r.a.createElement("main",null,r.a.createElement(j.a,{fluid:!0,className:"mt-4"},r.a.createElement(O.a,null,r.a.createElement(N.a,{xs:12,sm:6,md:3,xl:2,className:"mb-4"},null===this.state.roadNames?"":r.a.createElement(R,{selected:null===this.state.road?void 0:this.state.road.name,roads:this.state.roadNames,onClick:function(e){return t.getRoadDetails(e)}})),r.a.createElement(N.a,{xs:12,sm:6,md:{span:4,offset:5},xl:{span:3,offset:7},className:"mb-4"},null===this.state.road?"":r.a.createElement(S.a,null,r.a.createElement(S.a.Header,null,this.state.road.name),r.a.createElement(C.a,{className:"mb-0"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null,"\u9577\u3055"),r.a.createElement("td",{className:"text-right"},this.state.road.length," km")),r.a.createElement("tr",null,r.a.createElement("th",null,"\u8eca\u7dda\u6570"),r.a.createElement("td",{className:"text-right"},Object(i.a)(this.state.road.lanesCounts).join(" / "))),r.a.createElement("tr",null,r.a.createElement("th",null,"\u8d77\u70b9"),r.a.createElement("td",{className:"text-right"},Object(i.a)(this.state.road.start.names).map(function(t){return r.a.createElement("div",{key:t},t)}))),r.a.createElement("tr",null,r.a.createElement("th",null,"\u7d42\u70b9"),r.a.createElement("td",{className:"text-right"},Object(i.a)(this.state.road.end.names).map(function(t){return r.a.createElement("div",{key:t},t)}))))))))),r.a.createElement(g.a,{zoom:this.state.map.zoom,zoomControl:!1,center:this.state.map.center,maxZoom:18,onZoom:function(e){var a=e.target;return t.setState({map:Object(c.a)({},t.state.map,{zoom:a.getZoom()})})},onMoveEnd:function(e){var a=e.target;return t.setState({map:Object(c.a)({},t.state.map,{center:a.getCenter()})})}},r.a.createElement(w.a,{position:"bottomright"}),r.a.createElement(v.a,{url:"https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png",attribution:"<a href='https://maps.gsi.go.jp/development/ichiran.html' target='_blank'>\u5730\u7406\u9662\u30bf\u30a4\u30eb</a>"}),null!==this.state.road&&"start"in this.state.road?r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{position:this.state.road.start.coordinate},r.a.createElement(E.a,{key:this.state.road.name},r.a.createElement("h6",null,"\u8d77\u70b9"),Object(i.a)(this.state.road.start.names).map(function(t){return r.a.createElement("div",{key:t},t)}),r.a.createElement("div",null,this.state.road.start.coordinate.lat,", ",this.state.road.start.coordinate.lng))),r.a.createElement(y.a,{position:this.state.road.end.coordinate},r.a.createElement(E.a,{key:this.state.road.name},r.a.createElement("h6",null,"\u7d42\u70b9"),Object(i.a)(this.state.road.end.names).map(function(t){return r.a.createElement("div",{key:t},t)}),r.a.createElement("div",null,this.state.road.end.coordinate.lat,", ",this.state.road.end.coordinate.lng))),r.a.createElement(_.a,{key:this.state.road.name,data:this.state.road.route,style:{weight:6}})):"")))}}]),e}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var q=a(8);a.n(q).a.Icon.Default.imagePath="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.1/images/",o.a.render(r.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[44,1,2]]]);
//# sourceMappingURL=main.1d4fb789.chunk.js.map